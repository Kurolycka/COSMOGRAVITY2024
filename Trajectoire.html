<!DOCTYPE html>
<html lang="fr">
<head>

    <!-- icon probleme -->

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

    <title>Trajectoire Baryonique</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    
    
    <link rel="stylesheet" type="text/css" 
    href="./katex/katex.min.css">
    
    <script type="text/javascript" 
    src="./katex/katex.min.js"></script>
    
    <script type="text/javascript" 
    src="./katex/contrib/auto-render.min.js"></script>


    <!-- Scripts pour calculs -->
<script src="./Lib/jquery-1.12.3.min.js"></script>
<script src="./Lib/math.min.js"></script>
<script src="./Lib/d3.js"></script>
<script src="./Lib/snap.svg.js"></script>
<script src="./JavaScript/Trajectoire/calcul_trajectoire.js"></script>
<script src="./JavaScript/Trajectoire/bouttons.js"></script>
<script src="./JavaScript/Trajectoire/graphe_potentiel.js"></script>
<script src="./JavaScript/Trajectoire/Get_para.js"></script>
<script src="./JavaScript/Langues/gestion_langues.js"></script>
<script src="./JavaScript/Trajectoire/agrandit.js"></script>
<script src="./JavaScript/Trajectoire/pilotage.js"></script> 
<script src="./JavaScript/Trajectoire/fonctions_utilitaires_trajectoires.js"></script>
<script src="./JavaScript/fonction_utilitaire.js"></script>



<link rel="stylesheet" href="./CSS/styleTrajectoire.css">
<link rel="stylesheet" href="./CSS/styleAnimation.css">
<link rel="stylesheet" href="./CSS/styleNav.css">

<script src="./JavaScript/Graphisme/trajectoires.js"></script>

<!-- Pour enregistrer le graphe et le tracé -->
<script src="./Lib/saveSvgAsPng.js"></script>
<script src="./Lib/canvas-to-image.js"></script>

<!-- INCONE DE MERDOOOOOH IL FAUT LA METTRE -->
<link rel="icon" href="./Images/Icones/favicon.ico" type="image/x-icon" />

</head>
<body>


<div class="grillePrincipale">
    <div id="positionNav" class="Nav"></div>
    <!--Fenêtre entrée-->
    <button onclick="toggleEntreeSortie('panneauEntree')" class="petitBoutton"
            style="background-color: #BCA7DCFF; display:block; top: 60px; left:10px; position: absolute">
        <img id="flecheGauche" class="flècheMenu"
             src="./Images/fleche_menu.png"
             alt="">
    </button>
    <!-- Paramètres -->

    <input type="hidden" id="traject_type" name="traject_type" value="complete"></input>

    <input type="hidden" id="traject_type2" name="traject_type2" value="observateur"></input> 

    <input type="hidden" id="scalefactor" name="scalefactor" value=280></input> 

    <input type="hidden" id="canvaswidthheight"  value="750"></input> 

    <input type="hidden" id="boutton_ammorti" name="boutton_ammorti" value="0"></input>
    <!-- Permet de déterminer si il y a un tracé -->
    <input type="hidden" id="trace_present" name="trace_present" value="false"></input>



    <div id="panneauEntree" class="Entree">
        <div class="boiteEntree">
            <div id="Entrées">Entrées Astre</div>
            <span id="bouton_info">
                <img onclick="commandes();" src="Images/info.png" class="bouton_info">
                </span>
            <div id="champs_a_remplir_haut" class="pls-inputs-container">

                <div id="masse_div" class="input-wrapper">
                    <label id="masse_label"  for="masse_input">M (kg) </label>
                    <input id="masse_input" value="2e39" align="left" maxlength="10" type="text" size="10" onchange="verifnbr();initialisationGenerale(lenbdefusees)">
                </div>
        
                <div id="rayon_phy_div" class="input-wrapper">
                    <label title="" for="rayon_phy_input"  id="rayon_phy_label">r_phys (m)</label>
                    <input id="rayon_phy_input" value="0" align="left" maxlength="10" type="text" size="10" onchange="verifnbr();initialisationGenerale(lenbdefusees)">
                </div>
        
            </div>

        </div>


        <div class="boiteEntree">
            <div id="Entrées">Entrées Mobiles</div>
            <div id="nombre_de_fusees_div">
                <div id="nombre_de_fusees" class="input-wrapper">
                    <label title="" for="nombre_de_fusees_input"  id="nombre_de_fusees_label">Nombre de fusees</label>
                    <input id="nombre_de_fusees_input" value="1" type="text" size="2" onchange="supprHtml();genereHtml();save_nbfusees();updatenbredefusees();">
                </div>
                <span id="case">
                    <label id="labelgp" for="vr">See Potenial</label>
                    <input id="toggle" type="checkbox"  checked>
                    </span>
                    <label id="label_temps_allumage" for="temps_allumage" style="display: none;"></label> <!--ManonV3-->
                    <input id="temps_allumage" value="50" type="text" size="5" style="display: none;"> <!--ManonV3-->
                    <label id="label_puissance_reacteur" for="puissance_reacteur" style="display: none;"></label> <!--ManonV3-->
                    <input id="puissance_reacteur" value="100" type="text" size="5" style="display: none;"> <!--ManonV3-->
                </span>
                <div id="champs_a_remplir" ></div>
            </div>
        </div>
        
    </div>

    <!--Fenêtre graphe-->
    <div id="panneauGraphe" class="Graphe" style="position: relative;">
        
        <div class="boiteGraphe">
            <p id="txt_titre"></p>
            <div id="radio_button">
                <button id="trajectoire_complete" type="button" name="traj" class="bouttonChoix" value="complete" onclick="document.getElementById('traject_type').value = this.value;pressionBouttonTrajectoireComplete()">Trajectoire Complete</button>
                <button id="trajectoire_simple" type="button" name="traj2" class="bouttonChoix-inverse" value="simple" onclick="document.getElementById('traject_type').value = this.value;pressionBouttonTrajectoireSimple()">Trajectoire Simple</button>
                <button id="observateur" type="button" name="observateur" class="bouttonChoix" title="" value="observateur" onclick="document.getElementById('traject_type2').value = this.value;pressionBouttonObservateur();notationvitesseree2()">Observateur</button>
                <button id="spationaute" type="button" name="mobile" class="bouttonChoix-inverse" value="mobile" onclick="document.getElementById('traject_type2').value = this.value;pressionBouttonMobile();notationvitesseree2()">Spationaute</button>  
			    <button id="rebond" type="button" hidden name="reb" class="bouttonChoix" onclick="ammort();changerBouttonRebond()">Rebond</button>
            
            </div>

           <div class="wraper" id="barre_reb">
                <span id="amortissement">Coefficient </span>
                <input type="range" id="reb" max="100" min="0" value="0" name="rebond" oninput="ammortUpdate(value)" />&nbsp;
                <span for="reb" id="ammorti"></span>
            </div> 

            <div id="boutons_actions">
                <span id="buts">
                    <button type="button" class="grosBoutton" id="start" onclick="lancement()">Start</button>
                    <button type="button" class="grosBoutton"  id="pause/resume" style="display: none;" >Pause</button>
                </span>
        
                <span id="bouton">
                    <button type="button" id="clear" class="grosBoutton" onclick="save_nbfusees_recupvaleurs();save_schwarshild_massif(lenbdefusees);rafraichir();">Reset</button>
                </span>
                <span id="enregistrer">
                    <button id="boutton_enregis" type="button" class="grosBoutton" onclick="enregistrer();">Save</button>
                </span>
                <span id="recup">
                    <button id="boutton_recup" type="button" class="grosBoutton" onclick="recuperation();">Last Values</button>
                </span>
                   
            </div>
            
        </div>


        <div class="boiteGraphe">
            
        
                <div id="ct_tg2" class="table-container" >
                    <table  id="tg2"   >
                        <thead id="tableauresultatsimu"></thead>
                    </table>
                </div>
           
            
            <span id="indic_calculs"></span> 
    
            <div id="bloc_resultats">
                <div id="wrapper"></div>
                <div id="wrapper2"></div>
            </div>

            <!-- Panneau mobile zoom -->
            <div id="panneau_mobile2" >

                <label id="nzoomtxt" for="nzoom" style="border: 1px solid rgb(175, 175, 175); padding: 5px; border-radius: 25% ; ">nz=0</label>
                <span id="moinszoom">
                    <img id="moinsvi1" src="Images/moins.png" class="bouton_mobile" title="Zoom (-)">
                </span>

                <span id="initialiser">
                    <img id="pau1" src="Images/reset.png"  class="bouton_mobile" title="Echelle par défault">
                </span>

                <span id="pluszoom">
                    <img id="plusvi1" src="Images/plus.png" class="bouton_mobile" title="Zoom (+)">
                </span>
            </div>

            <!-- Panneau mobile qui apparait lorsque tracé -->

            <div id="panneau_mobile" >

                <span id="moinsvite">
                        <img id="moinsvi" src="Images/lent.png" class="bouton_mobile" title="Décélérer">
                </span>

                <span id="bouton_pause">
                    <img id="pau" src="Images/pause.png" class="bouton_mobile" title="Pause">
                </span>

                <span id="plusvite">
                    <img id="plusvi" src="Images/rapide.png" class="bouton_mobile" title="Accélérer (attention, réduit la précision)">
                </span>
                
                <label id="nsimtxt" for="nzoom" style="border: 1px solid rgb(175, 175, 175);  padding: 5px; border-radius: 25% ;">ns=0</label>

            </div>
           
        </div>



    </div>

    <!--Fenêtre sortie-->
    <button onclick="toggleEntreeSortie('panneauSortie')" class="petitBoutton"
            style="background-color: #BCA7DCFF; display:block; top: 60px; right:10px; position: absolute">
        <img id="flecheDroite" class="flècheMenu tournee"
             src="./Images/fleche_menu.png"
             alt="">
    </button>
    <div id="panneauSortie" class="Sortie">
        <div class="boiteSortie">

                <div id="ct_tg" class="table-container">
                    <table class="td" id="tg">
                        <thead id="tableau-sortie"></thead>
                    </table>
                </div>
           
        </div>

        <div class="boiteSortie">
            <div id="ct_tg2" class="table-container">
                <table class="td" id="tg2">
                    <thead id="tableau-sortie-2"></thead>
                </table>
            </div>

        </div>
    </div>
</div>


<div id="cccccccc">
<div id="joyDiv" style="width:130px;height:130px" ></div></div> 

<!-- Scripts pour resize et tracer du graphique au chargement + chargement du menu-->

<script>

    $(function() {
        $("#positionNav").load("Navigation.html");
    });
</script>

<script src="./JavaScript/Graphisme/Menu/nav.jquery.min.js"></script>

<script>
	init_rebond();
	genereHtml();
	initialisationGenerale(1);
	//Fonction qui lance la simulation avec le button start si tout est bien validé 
	function lancement(){
		
		//on lance si ya true en return
		if(typeof test_inte() === 'boolean')
		{
			save_nbfusees_recupvaleurs();
			save_schwarshild_massif(lenbdefusees);
			lancerDeFusees(lenbdefusees);
		}
		//sinon on affiche le message d'erreur
		else
		{
			alert(test_inte());
		}
	}

	function updatenbredefusees(){
		var nbredefuseesupdatenbr = Number(document.getElementById("nombre_de_fusees_input").value);	
		lenbdefusees = nbredefuseesupdatenbr;
		initialisationGenerale(nbredefuseesupdatenbr);
	}

	//AJOUTE PAR KHALED : pour ne pas laisser le choix à un utilisateur le nb de fusees s'il passe en mode spationaute
	var btnObervateur = document.getElementById("observateur");
    var btnSpationaute = document.getElementById("spationaute");
    var inputNbfusees = document.getElementById("nombre_de_fusees_input");
	var labelNbfusees = document.getElementById("nombre_de_fusees_label");
	var labelTempsAllumage = document.getElementById("label_temps_allumage"); //ManonV3
	var inputTempsAllumage = document.getElementById("temps_allumage"); //ManonV3
	var labelPuissanceReacteur = document.getElementById("label_puissance_reacteur"); //ManonV3
	var inputPuissanceReacteur = document.getElementById("puissance_reacteur"); //ManonV3
	var btnrebond = document.getElementById("rebond");
	var inputRphysique = document.getElementById("rayon_phy_input");


    // Ajouter des écouteurs d'événements pour les boutons
    btnObervateur.addEventListener("click", function() {
		inputNbfusees.style.display = "inline"; // Afficher le input et le label de nbfusees si button observateur est cliqué 
		labelNbfusees.style.display = "inline";
		labelTempsAllumage.style.display = "none"; //ManonV3
		inputTempsAllumage.style.display = "none"; //ManonV3
		labelPuissanceReacteur.style.display = "none"; //ManonV3
		inputPuissanceReacteur.style.display ="none"; //ManonV3
    });

    btnSpationaute.addEventListener("click", function() {
		inputNbfusees.value='1'; // on met un seul mobile
		const event = new Event('change');//on met à jour tout le changement en appelant la sa fonctionnalité de changement
		inputNbfusees.dispatchEvent(event);
		inputNbfusees.style.display="none";
		labelNbfusees.style.display = "none";
		labelTempsAllumage.style.display = "inline"; //ManonV3
		inputTempsAllumage.style.display = "inline"; //ManonV3
		labelPuissanceReacteur.style.display = "inline"; //ManonV3
		inputPuissanceReacteur.style.display = "inline"; //ManonV3
    });

	inputRphysique.addEventListener("input", function() {
		if(inputRphysique.value=="0" || inputRphysique.value==""){btnrebond.style.display="none";} 
		else{btnrebond.style.display="inline";}

    });
	


	var lenbdefusees;
	
    traceEstAbsent();
	//textesimutraj();

	document.getElementById('traject_type2').value="observateur";
	document.getElementById('traject_type').value="complete";

	save_nbfusees();
</script>


    <script type="text/javascript">
    //joystick
    // Create JoyStick object into the DIV 'joyDiv'
    var joy = new Pilotage('joyDiv');
    </script>

    <span id="enregistrer2"></span>

</body>
</html>
