<!DOCTYPE html>
<html lang="fr" class="nav-no-js">

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

	<!-- Css de la page -->
	<link rel="stylesheet" href="./CSS/Ancien/Css/Simu_grav.css">
	<link rel="stylesheet" href="./CSS/Ancien/Css/Simu_avertissement.css">
	<link rel="stylesheet" href="./CSS/styleNav.css">

	<script src="./JavaScript/Trajectoires/avertissement.js"></script>

	<!-- Latex dans Html -->

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

	<!-- The loading of KaTeX is deferred to speed up page rendering -->
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>

	<!-- To automatically render math in text elements, include the auto-render extension: -->
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
			onload="renderMathInElement(document.body);"></script>


	<link rel="stylesheet" type="text/css"
		  href="./JavaScript/Trajectoires/katex/katex.min.css">

	<script type="text/javascript"
			src="./JavaScript/Trajectoires/katex/katex.min.js"></script>

	<script type="text/javascript"
			src="./JavaScript/Trajectoires/katex/contrib/auto-render.min.js"></script>

	<script>
		document.addEventListener("DOMContentLoaded", function() {
			renderMathInElement(document.body, {
				// ...options...
				delimiters:[
					{left:"$",right:'$',display: false},
				]
			});
		});
	</script>

	<!-- Scripts pour calculs -->
	<script src="./node_modules/d3.js"></script>
	<script src="./node_modules/snap.svg.js"></script>
	<script src="./node_modules/jquery/dist/jquery.js"></script>
	<script src="./JavaScript/Langues/gestion_langues.js"></script>


	<script src="./JavaScript/Trajectoires/calcul_trajectoire_inter.js"></script>
	<script src="./JavaScript/Trajectoires/bouttons.js"></script>
	<script src="./JavaScript/Trajectoires/graphe_potentiel.js"></script>
	<script src="./JavaScript/Trajectoires/Get_para.js"></script>
	<script src="./JavaScript/Trajectoires/pilotage.js"></script>
	<script src="./JavaScript/Trajectoires/fonctions_utilitaires_trajectoires.js"></script>
	<script src="./JavaScript/Trajectoires/trajectoires.js"></script>

	<!-- Pour enregistrer le graphe et le tracé -->
	<script src="./node_modules/saveSvgAsPng.js"></script>
	<script src="./node_modules/canvas-to-image.js"></script>

	<!-- MENUS
    Source: http://www.cssscript.com/multi-level-toggle-responsive-navigation-menu-using-pure-css/
                                              -->
	<link rel="stylesheet" href="./CSS/Ancien/Css/Resp-Menu/normalize.min.css">
	<link rel="stylesheet" href="./CSS/Ancien/Css/Resp-Menu/defaults.min.css">
	<link rel="stylesheet" href="./CSS/Ancien/Css/Resp-Menu/nav-core.min.css">
	<link rel="stylesheet" href="./CSS/Ancien/Css/Resp-Menu/nav-layout.min.css">
	<script src="./JavaScript/Trajectoires/rem.min.js"></script>

		<title>Simulateur de trajectoire pour particule massive</title>
	</head>

	<body>
		<!-- Script Google Analytics -->
		<script>
			(function(i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function() {
				(i[r].q = i[r].q || []).push(arguments)
				}, i[r].l = 1 * new Date();
				a = s.createElement(o),
				m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-98631213-3', 'auto');
			ga('send', 'pageview');
		</script>

		<!-- Menus -->

		<header>
			<h1>Cosmogravity</h1>
		</header>

		<div id="positionNav" class="Nav"></div>
		<span id="bouton_info">
			<img onclick="commandes();" src="./Images/Anciennes_images/info.png" class="bouton_info">
		</span>
		<p id="txt_titre"></p>

		<!-- Paramètres -->

		<input type="hidden" id="traject_type" name="traject_type" value="complete"></input>

		<input type="hidden" id="traject_type2" name="traject_type2" value="observateur"></input> 

		<input type="hidden" id="scalefactor" name="scalefactor" value=280></input> 

		<input type="hidden" id="canvaswidthheight"  value="750"></input> 

		<!-- Permet de déterminer si il y a un tracé -->
		<input type="hidden" id="trace_present" name="trace_present" value="false"></input>
		<div id="corps">
			<div id="Bloc_Textee">	  
				<div id="trajectoire">
					<img onclick="avertissement_trajectoire();" src="./Images/Anciennes_images/warning.png" class="bouton_avertissement">
					<span id="txt_trajectoire"></span>
					<br/>
					<span id="txt_avertissement_trajectoire"></span>
				</div>
			</div>

		<div id="formulaire">
		<form name="params" id="parametres" action="" method="post" autocomplete="off">
		<div id="champs_a_remplir">
			<span id="masse">
				<label  id="massetxt" title= ""  for="M">M (kg) =</label>
				<input id="M" value="2e39" align="left" maxlength="10" type="text" size="10" onchange="verifnbr();initialisationGenerale(lenbdefusees)" oninput="initialisationGenerale(lenbdefusees)">
			</span>

			<span id="rayon_phy">
				<label title="" for="r_phy" id="txt_rphysique"></label>
				<input id="r_phy" value="1e18" align="left" maxlength="10" type="text" size="10" onchange="verifnbr();initialisationGenerale(lenbdefusees)" oninput="initialisationGenerale(lenbdefusees)">
			</span>

			
		</div>

		<div>
			<label id="labelnumberfusees" for="nombredefusees"></label>       
			<input id="nombredefusees" value="1" type="text" size="5" onchange="supprHtml();genereHtml();save_nbfusees();updatenbredefusees();">
			<span id="case">
				<label  id="labelgp" for="vr"></label>
				<input id="toggle" type="checkbox"  checked>
			</span>
			<label id="label_pourcentage_vphi_pilotage" for="pourcentage_vphi_pilotage" style="display: none;"></label>
			<input id="pourcentage_vphi_pilotage" value="0.03" type="text" size="5" style="display: none;">
		</div>

		<div id="radio_button">
			<button id="r1" type="button" name="traj" class="myButton" value="complete" onclick="document.getElementById('traject_type').value = this.value;pressionBouttonTrajectoireComplete()"></button>
			<button id="r2" type="button" name="traj2" class="myButton2" value="simple" onclick="document.getElementById('traject_type').value = this.value;pressionBouttonTrajectoireSimple()"></button>
			<button id="r3" type="button" name="observateur" class="myButton" value="observateur" onclick="document.getElementById('traject_type2').value = this.value;pressionBouttonObservateur();notationvitesseree2()"></button>
			<button id="r4" type="button" name="mobile" class="myButton2" value="mobile" onclick="document.getElementById('traject_type2').value = this.value;pressionBouttonMobile();notationvitesseree2()"></button> 
		</div>

		<div id="boutons_actions">
			<span id="buts">
				<button type="button" class="myButton" id="start" onclick="lancement()"></button>
				<button type="button" class="myButton3" id="pause/resume" style="display: none;" >Pause</button>

			</span>
			<span id="bouton">
				<button type="button" id="clear" class="myButton" onclick="save_schwarshild_massif_nonBar(lenbdefusees);rafraichir();"></button>
			</span>
			<span id="enregistrer">
				<button id="boutton_enregis" type="button" class="myButton" onclick="enregistrer();"></button>
			</span>
			<span id="recup">
				<button id="boutton_recup" type="button" class="myButton" onclick="recuperation();"></button>
			</span>
		</div>

		</form>
		</div>

		<!-- Table Resultats -->
		<div id="tab_resultats">

			<div id="ct_tg">
				<table class="tg" id="tg">
					<tbody id="tableauconstanteslers"></tbody>
				</table>
			</div>

			<div id="ct_tg2">
				<table class="tg2" id="tg2">
					<tbody id="tableauresultatsimu"></tbody>
				</table>
			</div>
		</div>
		<span id="indic_calculs"></span>
			<!-- Tracés -->

		<div id="bloc_resultats">
			<div id="wrapper">
			</div>
			<div id="wrapper2">
			</div>
		</div>
		</div>

		<!-- Panneau mobile zoom -->
		<div id="panneau_mobile2" >			
			<label id="nzoomtxt" for="nzoom" style="border: 1px solid rgb(175, 175, 175); padding: 5px; border-radius: 25% ; ">zoom=0</label>
			<span id="moinszoom">
				<img id="moinsvi1" src="./Images/Anciennes_images/moins.png" class="bouton_mobile" title="Zoom (-)">
			</span>
			<span id="initialiser">
				<img id="pau1" src="./Images/Anciennes_images/reset.png"  class="bouton_mobile" title="Echelle par défault">
			</span>
			<span id="pluszoom">
				<img id="plusvi1" src="./Images/Anciennes_images/plus.png" class="bouton_mobile" title="Zoom (+)">
			</span>
		</div>

		<!-- Panneau mobile qui apparait lorsque tracé -->
		<div id="panneau_mobile">
			
			<span id="moinsvite">
				<img id="moinsvi" src="./Images/Anciennes_images/lent.png" class="bouton_mobile" title="Décélérer">
			</span>
			<span id="bouton_pause">
				<img id="pau" src="./Images/Anciennes_images/pause.png" class="bouton_mobile" title="Pause">
			</span>
			<span id="plusvite">
				<img id="plusvi" src="./Images/Anciennes_images/rapide.png" class="bouton_mobile" title="Accélérer (attention, réduit la précision)">
			</span>
			<label id="nsimtxt" for="nzoom" style="border: 1px solid rgb(175, 175, 175);  padding: 5px; border-radius: 25% ;">simu=0</label>		
		</div>

		<div id="cccccccc">
		<div id="joyDiv" style="width:130px;height:130px" ></div></div>

		<!-- Scripts pour resize et tracer du graphique au chargement + chargement du menu-->
		<script src="./JavaScript/Trajectoires/nav.jquery.min.js"></script>

		<script>
			$(function() {
				$("#positionNav").load("Navigation.html");
			});
		
		genereHtml();
		initialisationGenerale(1);
		//Fonction qui lance la simulation avec le button start si tout est bien validé 
		function lancement(){
			
			//on lance si ya true en return
			if(typeof test_inte() === 'boolean')
			{
				save_schwarshild_massif_nonBar(lenbdefusees);
				lancerDeFusees(lenbdefusees);
			}
			//sinon on affiche le message d'erreur
			else
			{
				alert(test_inte());
			}
		}

		function commandes(){ //Fonction qui affiche l'alerte pour les commandes claviers. 
			var texte = o_recupereJson();
			alert(texte.page_trajectoire_massive.commandes);
		}

		function updatenbredefusees(){
			var nbredefuseesupdatenbr = Number(document.getElementById("nombredefusees").value);	
			lenbdefusees = nbredefuseesupdatenbr;	
			initialisationGenerale(nbredefuseesupdatenbr);
		}

		var btnObervateur = document.getElementById("r3");
        var btnSpationaute = document.getElementById("r4");
        var inputNbfusees = document.getElementById("nombredefusees");
		var labelNbfusees = document.getElementById("labelnumberfusees");
		var labelPourcentageVphiPilotage = document.getElementById("label_pourcentage_vphi_pilotage");
		var inputPourcentageVphiPilotage = document.getElementById("pourcentage_vphi_pilotage");

        // Ajouter des écouteurs d'événements pour les boutons
        btnObervateur.addEventListener("click", function() {
			inputNbfusees.style.display = "inline"; // Afficher le input et le label de nbfusees si button observateur est cliqué 
			labelNbfusees.style.display = "inline"; 
			labelPourcentageVphiPilotage.style.display = "none";
			inputPourcentageVphiPilotage.style.display = "none";
        });

        btnSpationaute.addEventListener("click", function() {
			/*Juste pour avoir les valeurs rentrées avant de cliquer sur spationaute*/
			const r01 = document.getElementById("r01").value;
			const v01 = document.getElementById("v01").value;
			const phi01 = document.getElementById("phi01").value;
			const teta1 = document.getElementById("teta1").value;

			inputNbfusees.value='1'; // on met un seul mobile
			const event = new Event('change');//on met à jour tout le changement en appelant la sa fonctionnalité de changement
			inputNbfusees.dispatchEvent(event);
			document.getElementById("r01").value=r01;
			document.getElementById("v01").value=v01;
			document.getElementById("phi01").value=phi01;
			document.getElementById("teta1").value=teta1;

			inputNbfusees.style.display = "none"; // Masquer le input et le label de nbfusees si button spationaute est cliqué 
			labelNbfusees.style.display = "none";
			labelPourcentageVphiPilotage.style.display = "inline";
			inputPourcentageVphiPilotage.style.display = "inline";
        });


		var lenbdefusees;

		$(function() {
			$("#nav-ici").load("Menu.html");
		});
		traceEstAbsent();
		textesimutraj();
		document.getElementById('traject_type2').value="observateur";
		document.getElementById('traject_type').value="complete";
		save_nbfusees();
		</script>

		<script type="text/javascript">
		//joystick
		// Create JoyStick object into the DIV 'joyDiv'
		var joy = new Pilotage('joyDiv');
		</script>

		<span id="enregistrer2"></span>
	</body>
</html>
